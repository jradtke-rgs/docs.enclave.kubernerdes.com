"use strict";(globalThis.webpackChunkdocs_enclave_kubernerdes_com=globalThis.webpackChunkdocs_enclave_kubernerdes_com||[]).push([[264],{8649(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"day-0/prerequisites","title":"Prerequisites","description":"Before beginning Day 1, download all required images and install workstation tooling. If you\'re building an air-gapped enclave, this is the last opportunity to pull anything from the internet.","source":"@site/docs/day-0/prerequisites.md","sourceDirName":"day-0","slug":"/day-0/prerequisites","permalink":"/docs/day-0/prerequisites","draft":false,"unlisted":false,"editUrl":"https://github.com/jradtke-rgs/docs.enclave.kubernerdes.com/edit/main/docs/day-0/prerequisites.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"prerequisites","title":"Prerequisites","sidebar_label":"Prerequisites","sidebar_position":4},"sidebar":"enclaveSidebar","previous":{"title":"Network Planning","permalink":"/docs/day-0/network-planning"},"next":{"title":"Overview","permalink":"/docs/day-1/"}}');var i=n(4848),t=n(8453);const l={id:"prerequisites",title:"Prerequisites",sidebar_label:"Prerequisites",sidebar_position:4},a="Prerequisites",d={},c=[{value:"Request Carbide License",id:"request-carbide-license",level:2},{value:"OS Images",id:"os-images",level:2},{value:"Workstation Tools",id:"workstation-tools",level:2},{value:"Required",id:"required",level:3},{value:"Recommended",id:"recommended",level:3},{value:"Ansible Inventory Pre-Work",id:"ansible-inventory-pre-work",level:2},{value:"PXE Boot Assets",id:"pxe-boot-assets",level:2},{value:"Helm Chart Sources",id:"helm-chart-sources",level:2},{value:"Container Image Pre-Pull (Air Gap)",id:"container-image-pre-pull-air-gap",level:2},{value:"Day 0 Checklist",id:"day-0-checklist",level:2}];function o(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"prerequisites",children:"Prerequisites"})}),"\n",(0,i.jsx)(s.p,{children:"Before beginning Day 1, download all required images and install workstation tooling. If you're building an air-gapped enclave, this is the last opportunity to pull anything from the internet."}),"\n",(0,i.jsx)(s.h2,{id:"request-carbide-license",children:"Request Carbide License"}),"\n",(0,i.jsx)(s.p,{children:"Contact your Rancher Government Solutions team to discuss your goals and to request your Carbide Key.  Typically this discussion will include timelines, KPIs and success criteria, etc.."}),"\n",(0,i.jsx)(s.h2,{id:"os-images",children:"OS Images"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Image"}),(0,i.jsx)(s.th,{children:"Version"}),(0,i.jsx)(s.th,{children:"Use"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"openSUSE Leap 15.5 ISO"}),(0,i.jsx)(s.td,{children:"15.5"}),(0,i.jsx)(s.td,{children:"nuc-00 admin host OS"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Harvester ISO"}),(0,i.jsx)(s.td,{children:"v1.7.1"}),(0,i.jsx)(s.td,{children:"Harvester nodes (nuc-01/02/03)"})]})]})]}),"\n",(0,i.jsx)(s.p,{children:"Download locations:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["openSUSE Leap: ",(0,i.jsx)(s.a,{href:"https://get.opensuse.org/leap/15.5/",children:"https://get.opensuse.org/leap/15.5/"})]}),"\n",(0,i.jsxs)(s.li,{children:["Harvester: ",(0,i.jsx)(s.a,{href:"https://github.com/harvester/harvester/releases",children:"https://github.com/harvester/harvester/releases"})]}),"\n"]}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Verify checksums"})," after downloading. Both projects publish SHA256 sums alongside their ISOs."]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sha256sum -c CHECKSUM\n"})}),"\n",(0,i.jsx)(s.h2,{id:"workstation-tools",children:"Workstation Tools"}),"\n",(0,i.jsx)(s.p,{children:"Install these on your laptop/workstation (not on any NUC):"}),"\n",(0,i.jsx)(s.h3,{id:"required",children:"Required"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Tool"}),(0,i.jsx)(s.th,{children:"Version"}),(0,i.jsx)(s.th,{children:"Install"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"kubectl"})}),(0,i.jsx)(s.td,{children:"\u2265 1.28"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.a,{href:"https://kubernetes.io/docs/tasks/tools/",children:"Install guide"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"helm"})}),(0,i.jsx)(s.td,{children:"\u2265 3.12"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"brew install helm"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ansible"})}),(0,i.jsx)(s.td,{children:"\u2265 2.15"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"pip3 install ansible"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ssh"})}),(0,i.jsx)(s.td,{children:"any"}),(0,i.jsx)(s.td,{children:"Pre-installed on macOS/Linux"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"recommended",children:"Recommended"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Tool"}),(0,i.jsx)(s.th,{children:"Use"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"k9s"})}),(0,i.jsx)(s.td,{children:"Terminal-based Kubernetes UI"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"jq"})}),(0,i.jsx)(s.td,{children:"JSON parsing for API responses"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"yq"})}),(0,i.jsx)(s.td,{children:"YAML processing"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"virtctl"})}),(0,i.jsx)(s.td,{children:"Harvester VM management (from KubeVirt)"})]})]})]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# macOS via Homebrew\nbrew install kubectl helm ansible k9s jq yq\n\n# virtctl \u2014 download binary matching your Harvester version\nVERSION=v1.7.1\ncurl -Lo virtctl https://github.com/kubevirt/kubevirt/releases/download/${VERSION}/virtctl-${VERSION}-darwin-amd64\nchmod +x virtctl\nsudo mv virtctl /usr/local/bin/\n"})}),"\n",(0,i.jsx)(s.h2,{id:"ansible-inventory-pre-work",children:"Ansible Inventory Pre-Work"}),"\n",(0,i.jsx)(s.p,{children:"The enclave repo uses Ansible for configuration management. Prepare your inventory before Day 1:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ini",children:"# Ansible/hosts\n[InfraNodesPhysical]\nnuc-00 ansible_host=10.10.12.10\n\n[InfraNodesVirtualMachines]\nnuc-00-01 ansible_host=10.10.12.8\nnuc-00-02 ansible_host=10.10.12.9\nnuc-00-03 ansible_host=10.10.12.93\n\n[HarvesterEdge]\nnuc-01 ansible_host=10.10.12.101\nnuc-02 ansible_host=10.10.12.102\nnuc-03 ansible_host=10.10.12.103\n\n[all:vars]\nansible_user=mansible\nansible_become=true\nansible_python_interpreter=/usr/bin/python3\nansible_ssh_private_key_file=~/.ssh/id_ed25519\n"})}),"\n",(0,i.jsx)(s.p,{children:"Generate an SSH key pair if you don't have one:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'ssh-keygen -t ed25519 -C "enclave-admin" -f ~/.ssh/id_ed25519\n'})}),"\n",(0,i.jsx)(s.h2,{id:"pxe-boot-assets",children:"PXE Boot Assets"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"nuc-00"})," will serve PXE boot for the Harvester nodes. Collect these during Day 0:"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Harvester ISO"})," \u2014 will be mounted or extracted on nuc-00's Apache root"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"IPXE or PXELINUX"})," \u2014 provided by the ",(0,i.jsx)(s.code,{children:"syslinux"})," package on openSUSE Leap"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Harvester iPXE config"})," \u2014 from the Harvester documentation (modify IP addresses for your subnet)"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Sample iPXE boot script (customize IPs):"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ipxe",children:"#!ipxe\nkernel http://10.10.12.10/harvester/vmlinuz \\\n  ip=dhcp \\\n  net.ifnames=1 \\\n  rd.cos.disable \\\n  rd.noverifyssl \\\n  console=tty1 \\\n  root=live:http://10.10.12.10/harvester/rootfs.squashfs \\\n  harvester.install.automatic=true \\\n  harvester.install.config_url=http://10.10.12.10/harvester/config-nuc-01.yaml\ninitrd http://10.10.12.10/harvester/initrd\nboot\n"})}),"\n",(0,i.jsx)(s.h2,{id:"helm-chart-sources",children:"Helm Chart Sources"}),"\n",(0,i.jsx)(s.p,{children:"The following Helm repos are needed. Pull them in advance if working air-gapped:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# cert-manager\nhelm repo add jetstack https://charts.jetstack.io\n\n# Rancher (RGS channel)\nhelm repo add rancher-prime https://charts.rancher.com/server-charts/prime\n\nhelm repo update\n"})}),"\n",(0,i.jsx)(s.p,{children:"To pre-pull charts for offline use:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"helm pull jetstack/cert-manager --version v1.14.0 --destination ./helm-cache/\nhelm pull rancher-prime/rancher --destination ./helm-cache/\n"})}),"\n",(0,i.jsx)(s.h2,{id:"container-image-pre-pull-air-gap",children:"Container Image Pre-Pull (Air Gap)"}),"\n",(0,i.jsxs)(s.p,{children:["For fully air-gapped deployments, use Hauler or ",(0,i.jsx)(s.code,{children:"cosign"})," to mirror RGS Carbide images to a local registry. The ",(0,i.jsx)(s.code,{children:"hauler"})," tool is the recommended approach:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# Install hauler\ncurl -sfL https://get.hauler.dev | bash\n\n# Mirror Rancher images\nhauler store sync --files rancher-images.txt\nhauler store serve\n"})}),"\n",(0,i.jsx)(s.p,{children:"Contact RGS for the Carbide image list and credentials."}),"\n",(0,i.jsx)(s.h2,{id:"day-0-checklist",children:"Day 0 Checklist"}),"\n",(0,i.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","openSUSE Leap 15.5 ISO downloaded and checksum verified"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Harvester v1.7.1 ISO downloaded and checksum verified"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Workstation tools installed: kubectl, helm, ansible, k9s"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","SSH key pair generated"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Ansible inventory stub created"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Helm chart repos added (or charts pre-pulled)"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","PXE boot scripts drafted with correct IPs"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","IP address plan finalized (see ",(0,i.jsx)(s.a,{href:"/docs/day-0/network-planning",children:"Network Planning"}),")"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Hardware assembled and powered on (see ",(0,i.jsx)(s.a,{href:"/docs/day-0/hardware",children:"Hardware"}),")"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453(e,s,n){n.d(s,{R:()=>l,x:()=>a});var r=n(6540);const i={},t=r.createContext(i);function l(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);